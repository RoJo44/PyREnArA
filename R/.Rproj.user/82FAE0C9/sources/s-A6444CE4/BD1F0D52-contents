library(aphanotus/borealis)

library(geomorph)
data(plethodon)

# GPA
Y.gpa <- gpagen(plethodon$land)
# Create a gm.prcomp object
PCA <- gm.prcomp(Y.gpa$coords)

# Morphospace plots
ggGMMplot(PCA, group = plethodon$species, group.title = 'species')
ggGMMplot(PCA, group = plethodon$species, group.title = 'species', convex.hulls = TRUE)
ggGMMplot(PCA, group = plethodon$species, group.title = 'species', convex.hulls = TRUE,
          axis1 = 1, axis2 = 3)
ggGMMplot(PCA, group = plethodon$species, group.title = 'species', convex.hulls = TRUE,
          viridis.color.option = 'plasma')
ggGMMplot(PCA, group = plethodon$species, group.title = 'species', convex.hulls = TRUE,
          color = c("royalblue","gray40"))

# Labeling points
ggGMMplot(PCA, group = plethodon$species, group.title = 'species', convex.hulls = TRUE,
          labels = plethodon$site,
          group.label.size = 8, point.label.size = 2,
          color = c("royalblue","gray40"))

# Plots with example shapes
ggGMMplot(PCA, group = plethodon$species, group.title = 'species', convex.hulls = TRUE,
          backtransform.examples = TRUE,
          ref.shape = Y.gpa$consensus)

# Custom links on the example shapes
pletho.links <- matrix(c(4,5,5,6,6,7,7,8,8,9,9,10,10,11,2,4,12,2,3,5),
                       ncol = 2, byrow = TRUE)
ggGMMplot(PCA, group = plethodon$species, group.title = 'species', convex.hulls = TRUE,
          backtransform.examples = TRUE,
          ref.shape = Y.gpa$consensus,
          bt.links = pletho.links)

# No links on the example shapes
ggGMMplot(PCA, group = plethodon$species, group.title = 'species', convex.hulls = TRUE,
          backtransform.examples = TRUE,
          ref.shape = Y.gpa$consensus,
          bt.links = "none")

# Example shapes displaysed as thin-plate spline (TPS) warp grids
ggGMMplot(PCA, group = plethodon$species, group.title = 'species', convex.hulls = TRUE,
          backtransform.examples = TRUE,
          ref.shape = Y.gpa$consensus,
          shape.method = "TPS",
          lm.labels = FALSE)
